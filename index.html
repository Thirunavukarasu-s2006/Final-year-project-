<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Complaint Portal</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>

    <div class="container">
        <h2>Register Your Complaint</h2>
        
        <div class="form-group">
            <label>Full Name</label>
            <input type="text" id="name" placeholder="Enter your name">
        </div>

        <div class="form-group">
            <label>Email Address</label>
            <input type="email" id="email" placeholder="Enter your email">
        </div>

        <div class="form-group">
            <label>Complaint Subject</label>
            <input type="text" id="subject" placeholder="Subject">
        </div>

        <div class="form-group">
            <label>Complaint Details</label>
            <textarea id="message" rows="5" placeholder="Describe your complaint"></textarea>
        </div>

        <button type="button" onclick="submitData()">Submit Complaint</button>
        
        <p id="status" style="margin-top:10px; font-weight:bold;"></p>
    </div>

    <script>       
        const supabaseUrl = 'https://ujosqevwywohwcprkngb.supabase.co'; 
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVqb3NxZXZ3eXdvaHdjcHJrbmdiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAxMDA1MjYsImV4cCI6MjA4NTY3NjUyNn0.BCwutZ9xI0xCAtO1Z10qsCCDrYQfONtzmO15-RopKc4'; 
        const supabase = supabase.createClient(supabaseUrl, supabaseKey);
        async function submitData() 
        {
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const subject = document.getElementById('subject').value;
            const message = document.getElementById('message').value;
            const statusText = document.getElementById('status');
            statusText.innerText = "Sending...";
            const { data, error } = await supabase
                .from('complaint') 
                .insert([
                    { 
                        name: name, 
                        email: email, 
                        subject: subject, 
                        description: message 
                    }
                ]);

            if (error) 
            {
                console.error(error);
                statusText.innerText = "Error: " + error.message;
                statusText.style.color = "red";
            } 
            else
            {
                statusText.innerText = "Success! Complaint Registered.";
                statusText.style.color = "green";
                document.getElementById('name').value = "";
                document.getElementById('email').value = "";
                document.getElementById('subject').value = "";
                document.getElementById('message').value = "";
            }
        }
    </script>
</body>
</html>
